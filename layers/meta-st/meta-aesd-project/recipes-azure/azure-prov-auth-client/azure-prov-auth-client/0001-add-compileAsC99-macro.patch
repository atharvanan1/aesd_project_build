From cd02d126bb7c8875a884ab4c09baf0ebdc9ca17e Mon Sep 17 00:00:00 2001
From: bcis93 <bryancisneros93@gmail.com>
Date: Sat, 25 Apr 2020 02:06:22 +0000
Subject: [PATCH] add-compileAsC99-macro

---
 CMakeLists.txt | 15 +++++++++++++++
 1 file changed, 15 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index f8a4cc0f8..350d00d78 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -3,6 +3,21 @@
 
 cmake_minimum_required(VERSION 2.8.11)
 
+macro(compileAsC99)
+    if (CMAKE_VERSION VERSION_LESS "3.1")
+        if (CMAKE_C_COMPILER_ID STREQUAL "GNU" OR CMAKE_C_COMPILER_ID STREQUAL "Clang")
+            set (CMAKE_C_FLAGS "--std=c99 ${CMAKE_C_FLAGS}")
+            if (NOT IN_OPENWRT)
+                set (CMAKE_CXX_FLAGS "--std=c++11 ${CMAKE_CXX_FLAGS}")
+            endif()
+        endif()
+    else()
+        set (CMAKE_C_STANDARD 99)
+        set (CMAKE_CXX_STANDARD 11)
+    endif()
+endmacro(compileAsC99)
+
+
 compileAsC99()
 
 set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DUSE_PROV_MODULE")
